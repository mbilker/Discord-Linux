'use strict';

console.log('I run before anything else');

var VoiceEngine = require('remote').require('./VoiceEngine');
var runWebpackCb = false;

function noop() {}

var VoiceEngineShim = {
  supported: true,

  autoEnable: false,

  enable: VoiceEngine.enable,

  supportsAutomaticVAD: function supportsAutomaticVAD() {
    return false;
  },
  supportsMultiplePTT: function supportsMultiplePTT() {
    return true;
  },
  supportsPTTReleaseDelay: function supportsPTTReleaseDelay() {
    return true;
  },


  setForceSend: VoiceEngine.setPTTActive,
  setInputMode: VoiceEngine.setInputMode,
  setOutputVolume: VoiceEngine.setOutputVolume,

  setVolumeChangeCallback: noop,

  setSelfMute: VoiceEngine.setSelfMute,
  setSelfDeaf: VoiceEngine.setSelfDeaf,
  setLocalMute: VoiceEngine.setLocalMute,
  setLocalVolume: VoiceEngine.setLocalVolume,
  createUser: VoiceEngine.createUser,
  destroyUser: VoiceEngine.destroyUser,
  //onSpeaking: VoiceEngine.onSpeaking,
  //onVoiceActivity: VoiceEngine.onVoiceActivity,
  //onDevicesChanged: VoiceEngine.onDevicesChanged,

  canSetInputDevice: function canSetInputDevice() {
    return true;
  },


  getInputDevices: VoiceEngine.getInputDevices,
  setInputDevice: VoiceEngine.setInputDevice,

  canSetOutputDevice: function canSetOutputDevice() {
    return false;
  },


  setOutputDevice: noop,

  getOutputDevices: VoiceEngine.getOutputDevices,
  setEncodingBitRate: VoiceEngine.setEncodingBitRate,

  supportsEncodingBitRate: function supportsEncodingBitRate() {
    return true;
  },


  setEchoCancellation: VoiceEngine.setEchoCancellation,
  setNoiseSuppression: VoiceEngine.setNoiseSuppression,
  setAutomaticGainControl: VoiceEngine.setAutomaticGainControl,

  canSetAttenuation: function canSetAttenuation() {
    return false;
  },
  canSetVoiceProcessing: function canSetVoiceProcessing() {
    return true;
  },


  setAttenuation: noop,

  onConnectionState: VoiceEngine.onConnectionState,
  connect: VoiceEngine.connect,
  disconnect: VoiceEngine.disconnect,
  handleSessionDescription: VoiceEngine.handleSessionDescription,
  handleSpeaking: VoiceEngine.handleSpeaking,
  debugDump: VoiceEngine.debugDump,

  setNoInputCallback: noop,
  setNoInputThreshold: noop,

  collectDiagnostics: function collectDiagnostics(callback) {
    callback(null);
  },


  diagnosticsEnabled: false,

  runDiagnostics: function runDiagnostics(callback) {
    callback(null);
  },
  getDiagnosticInfo: function getDiagnosticInfo() {
    return null;
  },


  supportsNativePing: false,

  setInputVolume: noop,
  setPingCallback: noop,

  playSound: VoiceEngine.playSound,

  Constants: {}
};

function webpackCb(chunkIds, moreModules) {
  if (runWebpackCb) return;
  runWebpackCb = true;

  console.log('parent webpack');

  setImmediate(afterInitialJsonp);
}

function injectedModule(module, exports, webpackRequire) {
  console.log('injected module');

  var webpackVoiceEngines = [0];
  var modules = webpackRequire.c;

  window.__webpackRequire = webpackRequire;
  window.__voiceEngines = webpackVoiceEngines;

  for (var i = 0; i < webpackRequire.m.length; i++) {
    if (modules[i] && modules[i].exports && modules[i].exports.handleSessionDescription) {
      webpackVoiceEngines[0] = modules[i];
      break;
    }
  }

  if (webpackVoiceEngines[0]) {
    console.log('Found exports of NativeVoiceEngine, setting to shim...');
    for (var i = 0; i < webpackVoiceEngines.length; i++) {
      Object.assign(webpackVoiceEngines[i].exports, VoiceEngineShim);
    }
  }

  module.exports = { mbilker: true };
}

function afterInitialJsonp() {
  console.log(window['webpackJsonp']);

  window['webpackJsonp']([0], [injectedModule]);
}

//window['webpackJsonp'] = console.log.bind(console, 'parent webpack:');
window['webpackJsonp'] = webpackCb;
//# sourceMappingURL=data:application/json;base64,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Z0JBQVAsR0FBMEIsY0FBMUIsQ0FOdUQ7QUFPdkQsU0FBTyxjQUFQLEdBQXdCLG1CQUF4QixDQVB1RDs7QUFTdkQsT0FBSyxJQUFJLElBQUksQ0FBSixFQUFPLElBQUksZUFBZSxDQUFmLENBQWlCLE1BQWpCLEVBQXlCLEdBQTdDLEVBQWtEO0FBQ2hELFFBQUksUUFBUSxDQUFSLEtBQWMsUUFBUSxDQUFSLEVBQVcsT0FBWCxJQUFzQixRQUFRLENBQVIsRUFBVyxPQUFYLENBQW1CLHdCQUFuQixFQUE2QztBQUNuRiwwQkFBb0IsQ0FBcEIsSUFBeUIsUUFBUSxDQUFSLENBQXpCLENBRG1GO0FBRW5GLFlBRm1GO0tBQXJGO0dBREY7O0FBT0EsTUFBSSxvQkFBb0IsQ0FBcEIsQ0FBSixFQUE0QjtBQUMxQixZQUFRLEdBQVIsQ0FBWSx3REFBWixFQUQwQjtBQUUxQixTQUFLLElBQUksSUFBSSxDQUFKLEVBQU8sSUFBSSxvQkFBb0IsTUFBcEIsRUFBNEIsR0FBaEQsRUFBcUQ7QUFDbkQsYUFBTyxNQUFQLENBQWMsb0JBQW9CLENBQXBCLEVBQXVCLE9BQXZCLEVBQWdDLGVBQTlDLEVBRG1EO0tBQXJEO0dBRkY7O0FBT0EsU0FBTyxPQUFQLEdBQWlCLEVBQUUsU0FBUyxJQUFULEVBQW5CLENBdkJ1RDtDQUF6RDs7QUEwQkEsU0FBUyxpQkFBVCxHQUE2QjtBQUMzQixVQUFRLEdBQVIsQ0FBWSxPQUFPLGNBQVAsQ0FBWixFQUQyQjs7QUFHM0IsU0FBTyxjQUFQLEVBQXVCLENBQUMsQ0FBRCxDQUF2QixFQUE0QixDQUFDLGNBQUQsQ0FBNUIsRUFIMkI7Q0FBN0I7OztBQU9BLE9BQU8sY0FBUCxJQUF5QixTQUF6QiIsImZpbGUiOiJ3ZWIuVm9pY2VFbmdpbmUuc2hpbS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnNvbGUubG9nKCdJIHJ1biBiZWZvcmUgYW55dGhpbmcgZWxzZScpO1xuXG52YXIgVm9pY2VFbmdpbmUgPSByZXF1aXJlKCdyZW1vdGUnKS5yZXF1aXJlKCcuL1ZvaWNlRW5naW5lJyk7XG52YXIgcnVuV2VicGFja0NiID0gZmFsc2U7XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG52YXIgVm9pY2VFbmdpbmVTaGltID0ge1xuICBzdXBwb3J0ZWQ6IHRydWUsXG5cbiAgYXV0b0VuYWJsZTogZmFsc2UsXG5cbiAgZW5hYmxlOiBWb2ljZUVuZ2luZS5lbmFibGUsXG5cbiAgc3VwcG9ydHNBdXRvbWF0aWNWQUQoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIHN1cHBvcnRzTXVsdGlwbGVQVFQoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG5cbiAgc3VwcG9ydHNQVFRSZWxlYXNlRGVsYXkoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG5cbiAgc2V0Rm9yY2VTZW5kOiBWb2ljZUVuZ2luZS5zZXRQVFRBY3RpdmUsXG4gIHNldElucHV0TW9kZTogVm9pY2VFbmdpbmUuc2V0SW5wdXRNb2RlLFxuICBzZXRPdXRwdXRWb2x1bWU6IFZvaWNlRW5naW5lLnNldE91dHB1dFZvbHVtZSxcblxuICBzZXRWb2x1bWVDaGFuZ2VDYWxsYmFjazogbm9vcCxcblxuICBzZXRTZWxmTXV0ZTogVm9pY2VFbmdpbmUuc2V0U2VsZk11dGUsXG4gIHNldFNlbGZEZWFmOiBWb2ljZUVuZ2luZS5zZXRTZWxmRGVhZixcbiAgc2V0TG9jYWxNdXRlOiBWb2ljZUVuZ2luZS5zZXRMb2NhbE11dGUsXG4gIHNldExvY2FsVm9sdW1lOiBWb2ljZUVuZ2luZS5zZXRMb2NhbFZvbHVtZSxcbiAgY3JlYXRlVXNlcjogVm9pY2VFbmdpbmUuY3JlYXRlVXNlcixcbiAgZGVzdHJveVVzZXI6IFZvaWNlRW5naW5lLmRlc3Ryb3lVc2VyLFxuICAvL29uU3BlYWtpbmc6IFZvaWNlRW5naW5lLm9uU3BlYWtpbmcsXG4gIC8vb25Wb2ljZUFjdGl2aXR5OiBWb2ljZUVuZ2luZS5vblZvaWNlQWN0aXZpdHksXG4gIC8vb25EZXZpY2VzQ2hhbmdlZDogVm9pY2VFbmdpbmUub25EZXZpY2VzQ2hhbmdlZCxcblxuICBjYW5TZXRJbnB1dERldmljZSgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcblxuICBnZXRJbnB1dERldmljZXM6IFZvaWNlRW5naW5lLmdldElucHV0RGV2aWNlcyxcbiAgc2V0SW5wdXREZXZpY2U6IFZvaWNlRW5naW5lLnNldElucHV0RGV2aWNlLFxuXG4gIGNhblNldE91dHB1dERldmljZSgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgc2V0T3V0cHV0RGV2aWNlOiBub29wLFxuXG4gIGdldE91dHB1dERldmljZXM6IFZvaWNlRW5naW5lLmdldE91dHB1dERldmljZXMsXG4gIHNldEVuY29kaW5nQml0UmF0ZTogVm9pY2VFbmdpbmUuc2V0RW5jb2RpbmdCaXRSYXRlLFxuXG4gIHN1cHBvcnRzRW5jb2RpbmdCaXRSYXRlKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuXG4gIHNldEVjaG9DYW5jZWxsYXRpb246IFZvaWNlRW5naW5lLnNldEVjaG9DYW5jZWxsYXRpb24sXG4gIHNldE5vaXNlU3VwcHJlc3Npb246IFZvaWNlRW5naW5lLnNldE5vaXNlU3VwcHJlc3Npb24sXG4gIHNldEF1dG9tYXRpY0dhaW5Db250cm9sOiBWb2ljZUVuZ2luZS5zZXRBdXRvbWF0aWNHYWluQ29udHJvbCxcblxuICBjYW5TZXRBdHRlbnVhdGlvbigpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgY2FuU2V0Vm9pY2VQcm9jZXNzaW5nKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuXG4gIHNldEF0dGVudWF0aW9uOiBub29wLFxuXG4gIG9uQ29ubmVjdGlvblN0YXRlOiBWb2ljZUVuZ2luZS5vbkNvbm5lY3Rpb25TdGF0ZSxcbiAgY29ubmVjdDogVm9pY2VFbmdpbmUuY29ubmVjdCxcbiAgZGlzY29ubmVjdDogVm9pY2VFbmdpbmUuZGlzY29ubmVjdCxcbiAgaGFuZGxlU2Vzc2lvbkRlc2NyaXB0aW9uOiBWb2ljZUVuZ2luZS5oYW5kbGVTZXNzaW9uRGVzY3JpcHRpb24sXG4gIGhhbmRsZVNwZWFraW5nOiBWb2ljZUVuZ2luZS5oYW5kbGVTcGVha2luZyxcbiAgZGVidWdEdW1wOiBWb2ljZUVuZ2luZS5kZWJ1Z0R1bXAsXG5cbiAgc2V0Tm9JbnB1dENhbGxiYWNrOiBub29wLFxuICBzZXROb0lucHV0VGhyZXNob2xkOiBub29wLFxuXG4gIGNvbGxlY3REaWFnbm9zdGljcyhjYWxsYmFjaykge1xuICAgIGNhbGxiYWNrKG51bGwpO1xuICB9LFxuXG4gIGRpYWdub3N0aWNzRW5hYmxlZDogZmFsc2UsXG5cbiAgcnVuRGlhZ25vc3RpY3MoY2FsbGJhY2spIHtcbiAgICBjYWxsYmFjayhudWxsKTtcbiAgfSxcblxuICBnZXREaWFnbm9zdGljSW5mbygpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSxcblxuICBzdXBwb3J0c05hdGl2ZVBpbmc6IGZhbHNlLFxuXG4gIHNldElucHV0Vm9sdW1lOiBub29wLFxuICBzZXRQaW5nQ2FsbGJhY2s6IG5vb3AsXG5cbiAgcGxheVNvdW5kOiBWb2ljZUVuZ2luZS5wbGF5U291bmQsXG5cbiAgQ29uc3RhbnRzOiB7fVxufTtcblxuZnVuY3Rpb24gd2VicGFja0NiKGNodW5rSWRzLCBtb3JlTW9kdWxlcykge1xuICBpZiAocnVuV2VicGFja0NiKSByZXR1cm47XG4gIHJ1bldlYnBhY2tDYiA9IHRydWU7XG5cbiAgY29uc29sZS5sb2coJ3BhcmVudCB3ZWJwYWNrJyk7XG5cbiAgc2V0SW1tZWRpYXRlKGFmdGVySW5pdGlhbEpzb25wKTtcbn1cblxuZnVuY3Rpb24gaW5qZWN0ZWRNb2R1bGUobW9kdWxlLCBleHBvcnRzLCB3ZWJwYWNrUmVxdWlyZSkge1xuICBjb25zb2xlLmxvZygnaW5qZWN0ZWQgbW9kdWxlJyk7XG5cbiAgdmFyIHdlYnBhY2tWb2ljZUVuZ2luZXMgPSBbMF07XG4gIHZhciBtb2R1bGVzID0gd2VicGFja1JlcXVpcmUuYztcblxuICB3aW5kb3cuX193ZWJwYWNrUmVxdWlyZSA9IHdlYnBhY2tSZXF1aXJlO1xuICB3aW5kb3cuX192b2ljZUVuZ2luZXMgPSB3ZWJwYWNrVm9pY2VFbmdpbmVzO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgd2VicGFja1JlcXVpcmUubS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChtb2R1bGVzW2ldICYmIG1vZHVsZXNbaV0uZXhwb3J0cyAmJiBtb2R1bGVzW2ldLmV4cG9ydHMuaGFuZGxlU2Vzc2lvbkRlc2NyaXB0aW9uKSB7XG4gICAgICB3ZWJwYWNrVm9pY2VFbmdpbmVzWzBdID0gbW9kdWxlc1tpXTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmICh3ZWJwYWNrVm9pY2VFbmdpbmVzWzBdKSB7XG4gICAgY29uc29sZS5sb2coJ0ZvdW5kIGV4cG9ydHMgb2YgTmF0aXZlVm9pY2VFbmdpbmUsIHNldHRpbmcgdG8gc2hpbS4uLicpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd2VicGFja1ZvaWNlRW5naW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgT2JqZWN0LmFzc2lnbih3ZWJwYWNrVm9pY2VFbmdpbmVzW2ldLmV4cG9ydHMsIFZvaWNlRW5naW5lU2hpbSk7XG4gICAgfVxuICB9XG5cbiAgbW9kdWxlLmV4cG9ydHMgPSB7IG1iaWxrZXI6IHRydWUgfTtcbn1cblxuZnVuY3Rpb24gYWZ0ZXJJbml0aWFsSnNvbnAoKSB7XG4gIGNvbnNvbGUubG9nKHdpbmRvd1snd2VicGFja0pzb25wJ10pO1xuXG4gIHdpbmRvd1snd2VicGFja0pzb25wJ10oWzBdLCBbaW5qZWN0ZWRNb2R1bGVdKTtcbn1cblxuLy93aW5kb3dbJ3dlYnBhY2tKc29ucCddID0gY29uc29sZS5sb2cuYmluZChjb25zb2xlLCAncGFyZW50IHdlYnBhY2s6Jyk7XG53aW5kb3dbJ3dlYnBhY2tKc29ucCddID0gd2VicGFja0NiO1xuIl19

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcmVsb2FkLmpzIn0=